# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Commands

**Development:**

- `npm run dev` - Start Vite development server with HMR
- `npm run build` - TypeScript build + Vite production build
- `npm run preview` - Preview production build

**Code Quality:**

- `npm run format:check` - Check code formatting with Prettier
- `npm run format` - Auto-format code with Prettier
- `npm run lint` - Run ESLint checks
- `npm run typecheck` - TypeScript type checking
- `npm run all` - Run format, lint, typecheck, and test sequentially

**Testing:**

- `npm test` - Run BDD tests with Playwright
- `npm run test:ui` - Run tests in Playwright UI mode

## Architecture

This is a React + TypeScript application using Vite as the build tool and Tailwind CSS for styling.

### Testing Setup (Playwright BDD)

The project uses Playwright with BDD (Behavior-Driven Development) for E2E testing:

- **Feature files:** `_features/*.feature` - Gherkin syntax test scenarios
- **Step definitions:** `test/steps/*.steps.ts` - TypeScript implementations using `createBdd()` from playwright-bdd
- **Generated tests:** `test/.gen/` - Auto-generated by `bddgen`, do not edit
- **Test reports:** `test/report/` (HTML), `test/results/` (artifacts)

Tests run against the Vite dev server at `http://localhost:5173` (auto-started unless in CI).

### Code Style

- Prettier: no semicolons, single quotes, Tailwind class sorting
- ESLint: TypeScript-ESLint with React Hooks rules

### BDD Workflow

The project follows a structured BDD workflow with four commands:

```
/discover     → DISCOVERY.yml (structured requirements)
/formulate    → _features/*.feature
/automate-red → step definitions + testIds
/automate-green → frontend implementation
```

### Test ID Architecture

**Tests own the test IDs.** Test IDs live in separate `*.testIds.ts` files (no Node.js dependencies), which both step definitions and frontend code import.

```typescript
// test/steps/counter.testIds.ts (pure JS, no Node deps)
export const testIds = {
  value: 'counter-value',
  incrementButton: 'counter-increment-button',
}

// test/steps/counter.steps.ts
import { testIds } from './counter.testIds'
export { testIds }

// src/App.tsx
import { testIds } from '../test/steps/counter.testIds'
<div data-testid={testIds.value}>{count}</div>
```

This ensures a single source of truth while avoiding Node.js imports in the browser bundle.
